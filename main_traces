============================= test session starts ==============================
platform linux -- Python 3.8.14, pytest-7.4.0, pluggy-1.2.0
rootdir: /dlrover
plugins: cov-5.0.0
collected 1 item

dlrover/python/tests/test_worker_diagnosis.py 0: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

3: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

4: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

5: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

6: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

7: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

8: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

9: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

10: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

11: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

12: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

13: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

14: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

15: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

16: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

17: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

18: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

19: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

20: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

21: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

22: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

23: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

24: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

25: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

26: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

27: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

28: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

29: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

30: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

31: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

32: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

33: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

34: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

35: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

36: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

37: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

38: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

39: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

40: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

41: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

42: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

43: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

44: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

45: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

46: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

47: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

48: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

49: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

50: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

51: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

52: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

53: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

54: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

55: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

56: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

57: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

58: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

59: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

60: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

61: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

62: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

63: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

64: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

65: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

66: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

67: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

68: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

69: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

70: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

71: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

72: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

73: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

74: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

75: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

76: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

77: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

78: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

79: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

80: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

81: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

82: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

83: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

84: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

85: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

86: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

87: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

88: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

89: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

90: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

91: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

92: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

93: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

94: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

95: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

96: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

97: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

98: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

99: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

100: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

101: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

102: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

103: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

105: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

106: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

107: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

108: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

109: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

111: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

112: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

113: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

114: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

115: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

116: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

117: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

118: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

119: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

120: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

121: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

122: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

123: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

124: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

125: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

126: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

127: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

128: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

129: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

130: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

131: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

132: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

133: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

134: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

135: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

136: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

137: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

138: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

139: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

140: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

141: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

142: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

143: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

144: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

145: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

146: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

147: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

148: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

149: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

150: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

151: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

152: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

153: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

154: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

155: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

156: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

157: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

158: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

159: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

160: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

161: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

162: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

163: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

164: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

165: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

166: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

167: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

168: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

169: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

170: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

171: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

172: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

173: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

174: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

175: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

176: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

177: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

178: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

179: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

180: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

181: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

182: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

183: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

184: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

185: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

186: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

187: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

188: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

189: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

190: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

191: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

192: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

193: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

194: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

195: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

196: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

197: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

198: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

199: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

200: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

201: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

202: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

203: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

204: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

205: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

206: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

207: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

208: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

209: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

210: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

211: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

212: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

213: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

214: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

215: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

216: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

217: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

218: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

219: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

220: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

221: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

222: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

223: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

224: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

225: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

226: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

227: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

228: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

229: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

230: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

231: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

232: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

233: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

234: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

235: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

236: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

237: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

238: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

239: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

240: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

241: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

242: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

243: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

244: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

245: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

246: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

247: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

248: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

249: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

250: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

251: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

252: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

253: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

254: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

255: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

256: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

257: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

258: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

259: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

260: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

261: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

262: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

263: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

264: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

265: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

266: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

267: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

268: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

269: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

270: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

271: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

272: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

273: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

274: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

275: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

276: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

277: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

278: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

279: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

280: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

281: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

282: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

283: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

284: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

285: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

286: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

287: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

288: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

289: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

290: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

291: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

292: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

293: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

294: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

295: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

296: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

297: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

298: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

299: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

300: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

301: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

302: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

303: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

304: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

305: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

306: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

307: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

308: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

309: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

310: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

311: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

312: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

313: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

314: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

315: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

316: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

317: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

318: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

319: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

320: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

321: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

322: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

323: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

324: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

325: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

326: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

327: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

328: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

329: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

330: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

331: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

332: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

333: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

334: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

335: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

336: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

337: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

338: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

339: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

340: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

341: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

342: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

343: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

344: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

345: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

346: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

347: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

348: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

349: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

350: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

351: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

353: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

354: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

355: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

356: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

357: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

359: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

360: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

361: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

362: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

363: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

364: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

365: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

366: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

367: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

368: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

369: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

370: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

371: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

372: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

373: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

374: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

375: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

376: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

377: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

378: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

379: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

380: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

381: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

382: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

383: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

384: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

385: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

386: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

387: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

388: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

389: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

390: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

391: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

392: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

393: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

394: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

395: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

396: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

398: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

400: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

401: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

402: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

403: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

404: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

405: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

406: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

407: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

408: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

409: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

410: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

411: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

412: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

413: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

414: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

415: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

416: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

417: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

418: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

419: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

420: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

421: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

422: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

423: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

432: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

433: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

434: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

435: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

436: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

437: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

438: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

439: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

440: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

441: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

442: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

443: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

444: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

445: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

446: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

447: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

448: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

449: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

450: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

451: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

452: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

453: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

454: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

455: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

456: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

457: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

458: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

459: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

460: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

461: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

462: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

463: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

464: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

465: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

466: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

467: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

468: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

469: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

470: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

471: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

472: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

473: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

474: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

475: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

476: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

477: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

478: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

479: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

482: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

483: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

484: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

485: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

486: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

487: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

488: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

489: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

490: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

491: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

492: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

493: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

494: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

495: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

496: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

497: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

498: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

499: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

500: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

501: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

502: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

503: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

504: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

505: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

506: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

507: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

508: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

509: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

510: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

511: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

512: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

513: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

514: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

515: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

516: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

517: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

518: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

519: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

521: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

522: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

523: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

524: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

525: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

526: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

528: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

529: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

531: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

532: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

534: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

535: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

536: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

537: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

539: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

540: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

542: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

543: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

544: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

545: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

546: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

547: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

548: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

549: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

550: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

551: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

552: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

553: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

554: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

555: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

556: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

557: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

558: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

559: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

560: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

561: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

562: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

563: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

564: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

565: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

566: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

567: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

568: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

569: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

570: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

571: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

572: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

573: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

574: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

575: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

576: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

577: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

578: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

579: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

580: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

581: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

582: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

583: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

584: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

585: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

586: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

587: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

588: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

589: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

590: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

591: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

593: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

594: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

595: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

596: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

597: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

599: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

600: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

601: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

602: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

604: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

605: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

606: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

608: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

609: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

610: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

611: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

612: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

613: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

614: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

615: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

616: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

617: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

618: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

619: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

620: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

621: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

622: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

623: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

624: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

625: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

626: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

627: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

628: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

629: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

630: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

631: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

632: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

633: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

634: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

635: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

636: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

637: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

638: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

639: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

640: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

641: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

642: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

643: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

644: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

645: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

646: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

647: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

648: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

649: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

650: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

651: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

652: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

653: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

654: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

655: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

656: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

657: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

658: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

659: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

660: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

661: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

662: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

663: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

664: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

665: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

666: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

667: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

668: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

670: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

672: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

673: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

674: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

675: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

676: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

677: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

678: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

679: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

680: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

682: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

683: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

684: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

686: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

687: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

688: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

689: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

690: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

691: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

692: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

693: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

694: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

695: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

696: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

697: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

698: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

699: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

700: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

701: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

702: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

703: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

704: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

705: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

706: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

707: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

708: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

709: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

710: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

711: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

712: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

713: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

714: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

715: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

716: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

717: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

718: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

719: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

720: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

721: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

722: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

723: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

724: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

725: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

726: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

727: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

728: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

729: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

730: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

731: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

732: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

733: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

734: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

735: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

736: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

737: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

738: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

739: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

740: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

741: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

742: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

743: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

744: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

745: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

746: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

747: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

748: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

749: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

750: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

751: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

752: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

753: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

754: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

755: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

756: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

757: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

758: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

759: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

761: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

762: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

763: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

764: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

765: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

766: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

768: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

769: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

770: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

771: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

772: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

773: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

774: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

775: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

776: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

777: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

778: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

779: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

780: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

781: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

782: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

783: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

784: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

786: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

788: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

789: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

790: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

791: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

792: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

793: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

794: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

795: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

796: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

797: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

798: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

799: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

800: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

801: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

802: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

803: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

804: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

805: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

806: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

807: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

808: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

809: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

810: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

811: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

812: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

813: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

814: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

815: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

816: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

817: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

818: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

819: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

820: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

821: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

822: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

823: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

824: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

825: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

826: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

827: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

828: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

829: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

830: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

831: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

832: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

833: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

834: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

835: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

836: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

837: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

838: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

839: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

840: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

841: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

842: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

843: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

844: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

845: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

846: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

847: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

848: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

849: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

850: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

851: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

852: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

853: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

854: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

855: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

856: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

857: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

858: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

859: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

860: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

861: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

862: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

863: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

864: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

865: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

866: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

867: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

868: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

869: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

870: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

871: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

872: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

873: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

875: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

876: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

877: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

878: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

880: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

881: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

882: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

883: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

884: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

885: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

886: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

887: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

888: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

889: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

890: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

891: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

892: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

893: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

894: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

895: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

896: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

897: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

898: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

899: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

900: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

901: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

904: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

905: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

907: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

908: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

910: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

911: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

912: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

913: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

914: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

915: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

916: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

917: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

918: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

919: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

920: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

921: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

922: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

923: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

924: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

925: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

926: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

927: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

928: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

929: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

930: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

931: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

932: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

933: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

934: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

935: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

937: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

938: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

939: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

940: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

941: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

942: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

944: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

945: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

946: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

947: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

948: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

949: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

950: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

951: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

952: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

953: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

954: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

955: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

956: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

957: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

958: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

959: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

960: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

961: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

962: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

963: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

964: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

968: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

970: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

972: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

973: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

974: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

975: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

976: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

977: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

979: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

980: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

982: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

983: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

984: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

985: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

986: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

987: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

988: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

989: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

990: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

991: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

992: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

993: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

994: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

995: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

996: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

997: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

998: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

999: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1000: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1001: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1002: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1003: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1004: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1005: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1006: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1007: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1008: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1009: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1010: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1011: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1012: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1013: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1014: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1015: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1016: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1017: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1018: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1019: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1020: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1021: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1022: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1023: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1024: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1025: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1026: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1027: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1028: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1029: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1030: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1031: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1032: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1033: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1034: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1035: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1036: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1037: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1038: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1039: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1040: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1041: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1042: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1043: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1044: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1045: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1046: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1047: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1048: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1049: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1050: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1051: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1052: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1053: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1054: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1055: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1056: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1057: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1058: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1059: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1060: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1061: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1062: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1063: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1064: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1065: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1066: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1067: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1068: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1069: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1070: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1071: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1072: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1073: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1074: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1075: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1076: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1077: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1078: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1079: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1082: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1083: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1084: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1085: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1086: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1087: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1088: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1090: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1091: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1092: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1094: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1096: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1097: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1098: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1099: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1100: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1101: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1102: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1103: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1104: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1105: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1106: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1107: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1108: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1109: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1110: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1111: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1112: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1113: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1114: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1115: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1116: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1117: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1118: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1119: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1121: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1122: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1124: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1125: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1126: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1127: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1128: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1129: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1130: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1131: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1132: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1133: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1134: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1135: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1136: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1137: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1138: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1139: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1140: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1141: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1142: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1143: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1144: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1145: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1146: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1147: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1148: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1149: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1150: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1151: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1152: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1153: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1154: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1155: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1156: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1157: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1158: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1159: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1160: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1161: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1162: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1163: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1164: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1165: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1166: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1167: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1168: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1169: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1170: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1173: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1174: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1175: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1176: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1178: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1179: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1180: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1181: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1183: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1184: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1185: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1186: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1187: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1188: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1189: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1190: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1191: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1192: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1193: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1194: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1195: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1196: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1197: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1198: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1199: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1200: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1201: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1202: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1203: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1204: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1205: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1206: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1207: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1208: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1209: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1210: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1211: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1212: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1213: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1214: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1215: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1216: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1217: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1218: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1219: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1220: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1221: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1222: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1223: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1224: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1225: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1226: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1227: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1228: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1229: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1230: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1231: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1232: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1233: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1234: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1235: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1236: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1237: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1238: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1239: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1240: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1241: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1242: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1243: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1244: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1245: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1246: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1247: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1248: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1249: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1250: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1251: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1252: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1253: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1254: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1255: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1256: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1257: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1258: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1259: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1260: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1261: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1262: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1263: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1264: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1265: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1266: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1267: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1268: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1269: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1270: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1271: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1272: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1273: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1274: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1275: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1276: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1277: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1278: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1279: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1280: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1281: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1282: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1283: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1284: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1285: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1286: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1287: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1288: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1289: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1290: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1291: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1292: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1293: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1294: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1295: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1296: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1297: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1298: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1299: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1301: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1303: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1304: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1305: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1306: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1307: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1308: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1309: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1310: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1311: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1312: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1313: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1316: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1317: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1318: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1319: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1320: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1321: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1322: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1323: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1324: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1325: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1326: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1327: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1328: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1329: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1330: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1331: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1332: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1333: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1334: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1335: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1336: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1337: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1338: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1339: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1340: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1341: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1342: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

1343: <module>@pretrain_glm.py:1489;wrapper@/opt/conda/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:346;main@pretrain_glm.py:1443;train@pretrain_glm.py:805;train_step@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/train_utils.py:736;forward_step@pretrain_glm.py:347;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:839;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:1153;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/input/kunlong.ckl/code/nowsd_stage2_merge_glm1227_full1dgqa_ckpt/hf_glm/modeling_glm.py:954;_wrapped_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1518;_call_impl@/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:1527;forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:825;_pre_forward@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:429;_pre_forward_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:464;_unshard@/opt/conda/lib/python3.8/site-packages/torch/distributed/fsdp/_runtime_utils.py:345;synchronize@/opt/conda/lib/python3.8/site-packages/torch/cuda/streams.py:221

.

============================== 1 passed in 3.58s ===============================
